{"version":3,"file":"idsk-in-page-navigation.js","sources":["../../../../src/govuk/components/idsk-in-page-navigation/idsk-in-page-navigation.mjs"],"sourcesContent":["/* eslint-disable */\n\n/**\n * InPageNavigation Component\n */\nfunction IdskInPageNavigation ($module) {\n  this.$module = $module\n}\n\n/**\n * InPageNavigation init function\n */\nIdskInPageNavigation.prototype.init = function () {\n  // Check for module\n  var $module = this.$module\n  if (!$module) {\n    return\n  }\n\n  // Check for button\n  var $links = $module.querySelectorAll('.idsk-in-page-navigation__link')\n  if (!$links) {\n    return\n  }\n\n  // list of all ids and titles\n  this.$arrTitlesAndElems = []\n  // Handle $link click events\n  $links.forEach(\n    function ($link) {\n      var $item = {}\n      $item.el = document.getElementById($link.href.split('#')[1])\n      this.$arrTitlesAndElems.push($item)\n      $link.addEventListener('click', this.handleClickLink.bind(this))\n    }.bind(this)\n  )\n\n  var $linkPanelButton = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel'\n  )\n  if (!$linkPanelButton) {\n    return\n  }\n  $module.boundCheckCloseClick = this.checkCloseClick.bind(this)\n  $module.boundHandleClickLinkPanel = this.handleClickLinkPanel.bind(this)\n  $linkPanelButton.addEventListener(\n    'click',\n    $module.boundHandleClickLinkPanel,\n    true\n  )\n\n  // Handle floating navigation\n  window.addEventListener('scroll', this.scrollFunction.bind(this))\n  // Handle case if the viewport is shor and there are more than one article - scrolling is not needed, but navigation pointer has to be updated\n  this.$module.labelChanged = false\n}\n\n/**\n * An event handler for click event on $link - add actual title to link panel\n *\n * @param {object} e\n */\nIdskInPageNavigation.prototype.handleClickLink = function (e) {\n  var $link = e.target || e.srcElement\n  var $id = $link.closest('.idsk-in-page-navigation__link').href.split('#')[1]\n  var $panelHeight = this.$module.getElementsByClassName(\n    'idsk-in-page-navigation__link-panel'\n  )[0].offsetHeight\n\n  setTimeout(\n    function () {\n      if (document.getElementById($id) != null) {\n        this.$module.labelChanged = true\n        this.changeCurrentLink($link)\n        window.scrollTo(\n          0,\n          document.getElementById($id).offsetTop - $panelHeight * 2.5\n        )\n      } else {\n        this.changeCurrentLink($link)\n      }\n    }.bind(this),\n    10\n  )\n}\n\n/**\n * An event handler for click event on $linkPanel - collapse or expand in page navigation menu\n *\n * @param {object} e\n */\nIdskInPageNavigation.prototype.handleClickLinkPanel = function (e) {\n  var $module = this.$module\n  var $linkPanelButton = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel'\n  )\n  var $expandedButton = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel-button'\n  )\n\n  $module.classList.add('idsk-in-page-navigation--expand')\n  $linkPanelButton.removeEventListener(\n    'click',\n    $module.boundHandleClickLinkPanel,\n    true\n  )\n  $expandedButton.setAttribute('aria-expanded', 'true')\n  $expandedButton.setAttribute(\n    'aria-label',\n    $expandedButton.getAttribute('data-text-for-show')\n  )\n  document.addEventListener('click', $module.boundCheckCloseClick, true)\n}\n\n/**\n * close navigation if the user click outside navigation\n *\n * @param {object} e\n */\nIdskInPageNavigation.prototype.checkCloseClick = function (e) {\n  var $el = e.target || e.srcElement\n  var $navigationList = $el.closest('.idsk-in-page-navigation__list')\n  var $module = this.$module\n  var $linkPanelButton = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel'\n  )\n  var $expandedButton = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel-button'\n  )\n\n  if ($navigationList == null) {\n    e.stopPropagation() // prevent bubbling\n    $module.classList.remove('idsk-in-page-navigation--expand')\n    $linkPanelButton.addEventListener(\n      'click',\n      $module.boundHandleClickLinkPanel,\n      true\n    )\n    document.removeEventListener('click', $module.boundCheckCloseClick, true)\n    $expandedButton.setAttribute('aria-expanded', 'false')\n    $expandedButton.setAttribute(\n      'aria-label',\n      $expandedButton.getAttribute('data-text-for-hide')\n    )\n  }\n}\n\n/**\n * When the user scrolls down from the top of the document, set position to fixed\n */\nIdskInPageNavigation.prototype.scrollFunction = function () {\n  var $module = this.$module\n  var $arrTitlesAndElems = this.$arrTitlesAndElems\n  var $parentModule = $module.parentElement\n  var $navTopPosition = $parentModule.offsetTop - 55 // padding\n  var $links = $module.querySelectorAll('.idsk-in-page-navigation__list-item')\n\n  if (window.pageYOffset <= $navTopPosition) {\n    $module.classList.remove('idsk-in-page-navigation--sticky')\n  } else {\n    $module.classList.add('idsk-in-page-navigation--sticky')\n  }\n\n  if (this.$module.labelChanged) {\n    this.$module.labelChanged = false\n  } else if ($module.classList.contains('idsk-in-page-navigation--sticky')) {\n    var $self = this\n    $arrTitlesAndElems.some(function ($item, $index) {\n      if (\n        $item.el.offsetTop >= window.scrollY &&\n        $item.el.offsetTop <= window.scrollY + window.innerHeight\n      ) {\n        $self.changeCurrentLink($links[$index])\n\n        return true\n      }\n      return false\n    })\n  } else {\n    this.changeCurrentLink($links[0])\n  }\n}\n\n/**\n * InPageNavigation changeCurrentLink handler\n */\nIdskInPageNavigation.prototype.changeCurrentLink = function (el) {\n  var $module = this.$module\n  var $currItem = el.closest('.idsk-in-page-navigation__list-item')\n  var $articleTitle = $currItem.querySelector(\n    '.idsk-in-page-navigation__link-title'\n  )\n  var $items = $module.querySelectorAll('.idsk-in-page-navigation__list-item')\n  var $linkPanelText = $module.querySelector(\n    '.idsk-in-page-navigation__link-panel-button'\n  )\n\n  $items.forEach(function ($item) {\n    $item.classList.remove('idsk-in-page-navigation__list-item--active')\n  })\n  $currItem.classList.add('idsk-in-page-navigation__list-item--active')\n  $linkPanelText.innerText = $articleTitle.innerText\n\n  // let active item be always visible\n  $currItem.scrollIntoView({\n    block: 'nearest',\n    inline: 'nearest'\n  })\n}\n\nexport default IdskInPageNavigation\n"],"names":[],"mappings":"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"}